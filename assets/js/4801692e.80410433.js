"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([["28419"],{86643:function(e,r,n){n.r(r),n.d(r,{metadata:()=>s,default:()=>p,frontMatter:()=>o,contentTitle:()=>a,toc:()=>c,assets:()=>l});var s=JSON.parse('{"id":"Access_from_an_internal_system","title":"\u4ECE\u5185\u90E8\u7CFB\u7EDF\u8BBF\u95EE","description":"Java \u4EA4\u4E92","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/Access_from_an_internal_system.md","sourceDirName":".","slug":"/Access_from_an_internal_system","permalink":"/Access_from_an_internal_system","draft":false,"unlisted":false,"editUrl":"https://github.com/lsfusion/platform/edit/master/docs/zh-CN/Access_from_an_internal_system.md","tags":[],"version":"current","lastUpdatedAt":null,"frontMatter":{"title":"\u4ECE\u5185\u90E8\u7CFB\u7EDF\u8BBF\u95EE"},"sidebar":"learn","previous":{"title":"\u4ECE\u5916\u90E8\u7CFB\u7EDF\u8BBF\u95EE","permalink":"/Access_from_an_external_system"},"next":{"title":"\u8BBF\u95EE\u5916\u90E8\u7CFB\u7EDF\uFF08EXTERNAL\uFF09","permalink":"/Access_to_an_external_system_EXTERNAL"}}'),t=n(74848),i=n(28453);let o={title:"\u4ECE\u5185\u90E8\u7CFB\u7EDF\u8BBF\u95EE"},a,l={},c=[{value:"Java \u4EA4\u4E92",id:"java-\u4EA4\u4E92",level:3},{value:"SQL \u4EA4\u4E92",id:"sql-\u4EA4\u4E92",level:3},{value:"\u793A\u4F8B",id:"\u793A\u4F8B",level:3}];function u(e){let r={a:"a",code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h3,{id:"java-\u4EA4\u4E92",children:"Java \u4EA4\u4E92"}),"\n",(0,t.jsx)(r.p,{children:"\u5728\u8FD9\u79CD\u7C7B\u578B\u7684\u4EA4\u4E92\u4E2D\uFF0C\u5185\u90E8\u7CFB\u7EDF\u53EF\u4EE5\u76F4\u63A5\u8BBF\u95EE lsFusion \u7CFB\u7EDF\u7684 Java \u5143\u7D20\uFF08\u5C31\u50CF\u8BBF\u95EE\u666E\u901A Java \u5BF9\u8C61\u4E00\u6837\uFF09\u3002\u8FD9\u610F\u5473\u7740\u60A8\u53EF\u4EE5\u6267\u884C\u4E0E\u4F7F\u7528\u7F51\u7EDC\u534F\u8BAE\u65F6\u76F8\u540C\u7684\u6240\u6709\u64CD\u4F5C\uFF0C\u540C\u65F6\u907F\u514D\u6B64\u7C7B\u4EA4\u4E92\u7684\u663E\u8457\u5F00\u9500\uFF08\u4F8B\u5982\u53C2\u6570\u5E8F\u5217\u5316/\u7ED3\u679C\u53CD\u5E8F\u5217\u5316\u7B49\uFF09\u3002\u6B64\u5916\uFF0C\u5982\u679C\u4EA4\u4E92\u975E\u5E38\u7D27\u5BC6\uFF08\u5373\uFF0C\u6267\u884C\u4E00\u4E2A\u64CD\u4F5C\u7684\u8FC7\u7A0B\u9700\u8981\u4E0D\u65AD\u8BBF\u95EE\u53CC\u65B9\u2014\u2014\u4ECE lsFusion \u7CFB\u7EDF\u5230\u53E6\u4E00\u4E2A\u7CFB\u7EDF\uFF0C\u53CD\u4E4B\u4EA6\u7136\uFF09\u548C/\u6216\u9700\u8981\u8BBF\u95EE\u7279\u5B9A\u5E73\u53F0\u5355\u5143\uFF0C\u5219\u8FD9\u79CD\u901A\u4FE1\u65B9\u6CD5\u66F4\u52A0\u65B9\u4FBF\u548C\u9AD8\u6548\u3002"}),"\n",(0,t.jsx)(r.p,{children:"\u503C\u5F97\u6CE8\u610F\u7684\u662F\uFF0C\u8981\u76F4\u63A5\u8BBF\u95EE lsFusion \u7CFB\u7EDF\u7684 Java \u5143\u7D20\uFF0C\u5FC5\u987B\u9996\u5148\u83B7\u53D6\u4E00\u4E2A\u5BF9\u8C61\u7684\u94FE\u63A5\uFF0C\u8BE5\u5BF9\u8C61\u5C06\u5177\u6709\u67E5\u627E\u8FD9\u4E9B Java \u5143\u7D20\u7684\u63A5\u53E3\u3002\u8FD9\u901A\u5E38\u901A\u8FC7\u4EE5\u4E0B\u4E24\u79CD\u65B9\u5F0F\u4E4B\u4E00\u5B8C\u6210\uFF1A"}),"\n",(0,t.jsxs)(r.ol,{children:["\n",(0,t.jsxs)(r.li,{children:["\u5982\u679C\u521D\u59CB\u8C03\u7528\u901A\u8FC7 ",(0,t.jsx)(r.a,{href:"/Access_to_an_internal_system_INTERNAL_FORMULA#javato",children:"Java \u4EA4\u4E92"}),' \u673A\u5236\u6765\u81EA lsFusion \u7CFB\u7EDF\uFF0C\u5219\u53EF\u4EE5\u4F7F\u7528\u5B8C\u6210\u8C03\u7528\u7684\u52A8\u4F5C\u5BF9\u8C61\u4F5C\u4E3A"\u641C\u7D22\u5BF9\u8C61"\uFF08\u6B64\u52A8\u4F5C\u7684\u7C7B\u5FC5\u987B\u7EE7\u627F\u81EA ',(0,t.jsx)(r.code,{children:"lsfusion.server.physics.dev.integration.internal.to.InternalAction"}),"\uFF0C\u8BE5\u7C7B\u53C8\u5177\u6709\u6240\u6709\u5FC5\u9700\u7684\u63A5\u53E3\uFF09\u3002"]}),"\n",(0,t.jsxs)(r.li,{children:["\u5982\u679C\u5FC5\u987B\u4ECE\u5176\u65B9\u6CD5\u8BBF\u95EE lsFusion \u7CFB\u7EDF\u7684\u5BF9\u8C61\u662F Spring bean\uFF0C\u5219\u53EF\u4EE5\u4F7F\u7528\u4F9D\u8D56\u6CE8\u5165\u83B7\u53D6\u4E1A\u52A1\u903B\u8F91\u5BF9\u8C61\u7684\u94FE\u63A5\uFF08\u8BE5 bean \u76F8\u5E94\u5730\u79F0\u4E3A ",(0,t.jsx)(r.code,{children:"businessLogics"}),"\uFF09\u3002"]}),"\n"]}),"\n",(0,t.jsx)(r.h3,{id:"sql-\u4EA4\u4E92",children:"SQL \u4EA4\u4E92"}),"\n",(0,t.jsxs)(r.p,{children:["\u80FD\u591F\u8BBF\u95EE lsFusion \u7CFB\u7EDF\u7684 SQL \u670D\u52A1\u5668\u7684\u7CFB\u7EDF\uFF08\u4F8B\u5982\uFF0C\u8FD9\u6837\u7684\u7CFB\u7EDF\u4E4B\u4E00\u662F SQL \u670D\u52A1\u5668\u672C\u8EAB\uFF09\u53EF\u4EE5\u4F7F\u7528 SQL \u670D\u52A1\u5668\u65B9\u5F0F\u76F4\u63A5\u8BBF\u95EE\u7531 lsFusion \u7CFB\u7EDF\u521B\u5EFA\u7684 ",(0,t.jsx)(r.a,{href:"/Tables",children:"\u8868"})," \u548C ",(0,t.jsx)(r.a,{href:"/Materializations",children:"\u5B57\u6BB5"}),"\u3002\u5E94\u8BE5\u8BB0\u4F4F\uFF0C\u867D\u7136\u8BFB\u53D6\u6570\u636E\u76F8\u5BF9\u5B89\u5168\uFF08\u9664\u4E86\u53EF\u80FD\u5220\u9664/\u4FEE\u6539\u8868\u53CA\u5176\u5B57\u6BB5\uFF09\uFF0C\u4F46\u5199\u5165\u6570\u636E\u65F6\u4E0D\u4F1A\u89E6\u53D1\u4EFB\u4F55 ",(0,t.jsx)(r.a,{href:"/Events",children:"\u4E8B\u4EF6"}),"\uFF08\u5305\u62EC\u4F7F\u7528\u5B83\u4EEC\u7684\u6240\u6709\u5143\u7D20 - ",(0,t.jsx)(r.a,{href:"/Constraints",children:"\u7EA6\u675F"}),"\u3001",(0,t.jsx)(r.a,{href:"/Aggregations",children:"\u805A\u5408"})," \u7B49\uFF09\uFF0C\u4E5F\u4E0D\u4F1A\u91CD\u65B0\u8BA1\u7B97\u4EFB\u4F55 ",(0,t.jsx)(r.a,{href:"/Materializations",children:"\u7269\u5316"}),"\u3002\u56E0\u6B64\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u4E0D\u8981\u76F4\u63A5\u5C06\u6570\u636E\u5199\u5165 lsFusion \u7CFB\u7EDF\u8868\u3002\u5982\u679C\u5FC5\u987B\u8FD9\u6837\u505A\uFF0C\u5E94\u8003\u8651\u4E0A\u8FF0\u6240\u6709\u56E0\u7D20\u3002"]}),"\n",(0,t.jsx)(r.h3,{id:"\u793A\u4F8B",children:"\u793A\u4F8B"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'package lsfusion.server.logics.property.actions;\r\n\r\nimport lsfusion.base.BaseUtils;\r\nimport lsfusion.base.col.interfaces.immutable.ImMap;\r\nimport lsfusion.interop.remote.UserInfo;\r\nimport lsfusion.server.classes.ValueClass;\r\nimport lsfusion.server.data.SQLHandledException;\r\nimport lsfusion.server.logics.AuthenticationLogicsModule;\r\nimport lsfusion.server.logics.DataObject;\r\nimport lsfusion.server.logics.linear.LCP;\r\nimport lsfusion.server.logics.property.CalcProperty;\r\nimport lsfusion.server.logics.property.ClassPropertyInterface;\r\nimport lsfusion.server.logics.property.ExecutionContext;\r\nimport lsfusion.server.logics.scripted.ScriptingActionProperty;\r\nimport lsfusion.server.logics.scripted.ScriptingErrorLog;\r\n\r\nimport java.sql.SQLException;\r\nimport java.util.Iterator;\r\nimport java.util.Random;\r\n\r\npublic class GenerateLoginPasswordActionProperty extends ScriptingActionProperty {\r\n\r\n    private LCP email;\r\n    private LCP loginCustomUser;\r\n    private LCP sha256PasswordCustomUser;\r\n\r\n    private final ClassPropertyInterface customUserInterface;\r\n\r\n    public GenerateLoginPasswordActionProperty(AuthenticationLogicsModule LM, ValueClass... classes) throws ScriptingErrorLog.SemanticErrorException {\r\n        super(LM, classes);\r\n\r\n        this.email = findProperty("email[Contact]");\r\n        this.loginCustomUser = findProperty("login[CustomUser]");\r\n        this.sha256PasswordCustomUser = findProperty("sha256Password[CustomUser]");\r\n\r\n        Iterator<ClassPropertyInterface> i = interfaces.iterator();\r\n        customUserInterface = i.next();\r\n    }\r\n\r\n    public void executeCustom(ExecutionContext<ClassPropertyInterface> context) throws SQLException, SQLHandledException {\r\n        DataObject userObject = context.getDataKeyValue(customUserInterface);\r\n\r\n        String currentEmail = (String) email.read(context, userObject);\r\n\r\n        String login;\r\n        int indexMail;\r\n        if(currentEmail != null && (indexMail = currentEmail.indexOf("@"))>=0)\r\n            login = currentEmail.substring(0, indexMail);\r\n        else\r\n            login = "login" + userObject.object;\r\n\r\n        Random rand = new Random();\r\n        String chars = "0123456789abcdefghijklmnopqrstuvwxyz";\r\n        String password = "";\r\n        for(int i=0;i<8;i++)\r\n            password += chars.charAt(rand.nextInt(chars.length()));\r\n\r\n        if (loginCustomUser.read(context, userObject) == null)\r\n            loginCustomUser.change(login, context, userObject);\r\n        String sha256Password = BaseUtils.calculateBase64Hash("SHA-256", password, UserInfo.salt);\r\n        sha256PasswordCustomUser.change(sha256Password, context, userObject);\r\n    }\r\n}\n'})})]})}function p(e={}){let{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},28453:function(e,r,n){n.d(r,{R:()=>o,x:()=>a});var s=n(96540);let t={},i=s.createContext(t);function o(e){let r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);