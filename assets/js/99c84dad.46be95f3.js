"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([["95168"],{15443:function(e,r,n){n.r(r),n.d(r,{metadata:()=>d,default:()=>h,frontMatter:()=>i,contentTitle:()=>t,toc:()=>c,assets:()=>o});var d=JSON.parse('{"id":"How-to_Events","title":"\u4E8B\u4EF6","description":"\u793A\u4F8B 1","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/How-to_Events.md","sourceDirName":".","slug":"/How-to_Events","permalink":"/How-to_Events","draft":false,"unlisted":false,"editUrl":"https://github.com/lsfusion/platform/edit/master/docs/zh-CN/How-to_Events.md","tags":[],"version":"current","lastUpdatedAt":null,"frontMatter":{"title":"\u4E8B\u4EF6"},"sidebar":"learn","previous":{"title":"SEEK","permalink":"/How-to_SEEK"},"next":{"title":"\u58F0\u660E\u5F0F\u903B\u8F91","permalink":"/How-to_Declarative_logic"}}'),l=n(74848),s=n(28453);let i={title:"\u4E8B\u4EF6"},t,o={},c=[{value:"\u793A\u4F8B 1",id:"\u793A\u4F8B-1",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:3},{value:"\u793A\u4F8B 2",id:"\u793A\u4F8B-2",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-1",level:3},{value:"\u793A\u4F8B 3",id:"\u793A\u4F8B-3",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-2",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-2",level:3},{value:"\u793A\u4F8B 4",id:"\u793A\u4F8B-4",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-3",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-3",level:3}];function a(e){let r={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.h2,{id:"\u793A\u4F8B-1",children:"\u793A\u4F8B 1"}),"\n",(0,l.jsx)(r.h3,{id:"\u4EFB\u52A1",children:"\u4EFB\u52A1"}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4EEC\u6709\u4E00\u4E2A\u8BA2\u5355\uFF0C\u5305\u542B\u65E5\u671F\u3001\u7F16\u53F7\u548C\u662F\u5426\u5DF2\u5173\u95ED\u7684\u6807\u8BB0\u3002"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"CLASS Order '\u8BA2\u5355';\r\nisClosed '\u5DF2\u5173\u95ED' = DATA BOOLEAN (Order);\r\ndate '\u65E5\u671F' = DATA DATE (Order);\r\nnumber '\u7F16\u53F7' = DATA INTEGER (Order);\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4EEC\u9700\u8981\u786E\u4FDD\u8BA2\u5355\u5728\u5F53\u5929\u7ED3\u675F\u65F6\u81EA\u52A8\u5173\u95ED\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"// \u9009\u9879 1\r\nWHEN SET(date(Order o) < currentDate()) DO\r\n    isClosed(o) <- TRUE;\r\n\r\n// \u9009\u9879 2\r\nWHEN CHANGED(currentDate()) AND date(Order o) < currentDate() DO\r\n    isClosed(o) <- TRUE;\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u5728\u7B2C\u4E00\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4E8B\u4EF6\u53EA\u4F1A\u5728\u8868\u8FBE\u5F0F\u5185\u7684",(0,l.jsxs)(r.a,{href:"/Change_operators_SET_CHANGED_etc",children:[(0,l.jsx)(r.code,{children:"SET"}),"\u64CD\u4F5C\u7B26"]}),"\u53D1\u751F\u53D8\u5316\u65F6\u5728\u4E00\u4E2A\u4E8B\u52A1\u4E2D\u6267\u884C\u3002\u4E5F\u5C31\u662F\u8BF4\uFF0C\u5728\u8BA2\u5355\u65E5\u671F\u53D8\u5F97\u5C0F\u4E8E\u5F53\u524D\u65E5\u671F\u7684\u90A3\u4E00\u523B\u3002\u4F46\u662F\uFF0C\u5982\u679C\u7528\u6237\u624B\u52A8\u5C06\u8BA2\u5355\u65E5\u671F\u66F4\u6539\u4E3A\u5927\u4E8E\u5F53\u524D\u65E5\u671F\u5E76\u4FDD\u5B58\uFF0C\u7CFB\u7EDF\u5C06\u81EA\u52A8\u6267\u884C\u6B64\u4E8B\u4EF6\u5E76\u5173\u95ED\u8BA2\u5355\u3002\u56E0\u6B64\uFF0C\u7B2C\u4E8C\u79CD\u9009\u9879\u66F4\u53EF\u53D6\uFF0C\u56E0\u4E3A\u5B83\u53EA\u4F1A\u5728\u5348\u591C\u5F53\u524D\u65E5\u671F\u66F4\u6539\u65F6\u751F\u6548\u3002"]}),"\n",(0,l.jsx)(r.h2,{id:"\u793A\u4F8B-2",children:"\u793A\u4F8B 2"}),"\n",(0,l.jsx)(r.h3,{id:"\u4EFB\u52A1-1",children:"\u4EFB\u52A1"}),"\n",(0,l.jsxs)(r.p,{children:["\u7C7B\u4F3C\u4E8E",(0,l.jsx)(r.a,{href:"#%E7%A4%BA%E4%BE%8B-1",children:(0,l.jsx)(r.strong,{children:"\u793A\u4F8B 1"})}),"\uFF0C\u4F46\u8BA2\u5355\u5305\u542B\u6570\u91CF\u3001\u4EF7\u683C\u548C\u603B\u8BA1\u7684\u660E\u7EC6\u884C\u3002"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"CLASS OrderDetail '\u8BA2\u5355\u9879';\r\norder '\u8BA2\u5355' = DATA Order (OrderDetail) NONULL DELETE;\r\n\r\nquantity '\u6570\u91CF' = DATA NUMERIC[15,3] (OrderDetail);\r\nprice '\u4EF7\u683C' = DATA NUMERIC[14,2] (OrderDetail);\r\nsum '\u91D1\u989D' = DATA NUMERIC[16,2] (OrderDetail);\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4EEC\u9700\u8981\u786E\u4FDD\u5F53\u4EF7\u683C\u6216\u6570\u91CF\u66F4\u6539\u65F6\uFF0C\u5B83\u4EEC\u7684\u4E58\u79EF\u4F1A\u81EA\u52A8\u8BB0\u5F55\u4E3A\u603B\u91D1\u989D\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u89E3\u51B3\u65B9\u6848-1",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"WHEN LOCAL (CHANGED(quantity(OrderDetail d)) OR CHANGED(price(d)))\r\n            AND NOT CHANGED(sum(d)) DO {\r\n    sum(d) <- NUMERIC[16,2](quantity(d) * price(d));\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:[(0,l.jsx)(r.code,{children:"LOCAL"}),"\u7C7B\u578B\u7684\u4E8B\u4EF6\u8BA1\u7B97\u6240\u6709\u5C5E\u6027\u53D8\u5316\u65F6\uFF0C\u4E0D\u662F\u76F8\u5BF9\u4E8E\u6570\u636E\u5E93\u7684\u72B6\u6001\uFF0C\u800C\u662F\u76F8\u5BF9\u4E8E\u6B64\u4E8B\u4EF6\u4E0A\u4E00\u6B21\u53D1\u751F\u65F6\uFF08\u6216\u8005\u66F4\u51C6\u786E\u5730\u8BF4\uFF0C\u662F\u5904\u7406\u7ED3\u675F\u65F6\uFF09\u7684\u503C\u3002\u6211\u4EEC\u9700\u8981\u68C0\u67E5",(0,l.jsx)(r.code,{children:"sum"}),"\u662F\u5426\u672A\u66F4\u6539\uFF0C\u4EE5\u907F\u514D\u64E6\u9664\u4E4B\u524D\u66F4\u6539\u6240\u505A\u7684\u4FEE\u6539\u3002\u4F8B\u5982\uFF0C\u5982\u679C\u8BA2\u5355\u884C\u662F\u4ECE\u6587\u4EF6\u5BFC\u5165\u7684\uFF0C\u5176\u4E2D\u8BB0\u5F55\u4E86\u6570\u91CF\u3001\u4EF7\u683C\u548C\u91D1\u989D\uFF0C\u5219\u6B64\u4E8B\u4EF6\u5C06\u4E0D\u518D\u751F\u6548\u3002"]}),"\n",(0,l.jsx)(r.h2,{id:"\u793A\u4F8B-3",children:"\u793A\u4F8B 3"}),"\n",(0,l.jsx)(r.h3,{id:"\u4EFB\u52A1-2",children:"\u4EFB\u52A1"}),"\n",(0,l.jsxs)(r.p,{children:["\u7C7B\u4F3C\u4E8E",(0,l.jsx)(r.a,{href:"#%E7%A4%BA%E4%BE%8B-2",children:(0,l.jsx)(r.strong,{children:"\u793A\u4F8B 2"})}),"\uFF0C\u4F46\u8BA2\u5355\u9879\u6307\u5B9A\u4E86\u4E00\u672C\u4E66\u3002\u6BCF\u672C\u4E66\u4E5F\u6709\u4E00\u4E2A\u9ED8\u8BA4\u4EF7\u683C\u3002"]}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"CLASS Book '\u4E66\u7C4D';\r\nname '\u540D\u79F0' = DATA ISTRING[50] (Book);\r\nprice '\u4EF7\u683C' = DATA NUMERIC[14,2] (Book);\r\n\r\nbook '\u4E66\u7C4D' = DATA Book (OrderDetail);\r\nnameBook '\u4E66\u7C4D' (OrderDetail d) = name(book(d));\r\n\r\nFORM order\r\n    OBJECTS o = Order PANEL\r\n    PROPERTIES(o) date, number\r\n\r\n    OBJECTS d = OrderDetail\r\n    PROPERTIES(d) nameBook, quantity, price, sum\r\n    FILTERS order(d) == o\r\n;\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4EEC\u9700\u8981\u786E\u4FDD\u5F53\u4E66\u7C4D\u66F4\u6539\u65F6\uFF0C\u4EF7\u683C\u4F1A\u81EA\u52A8\u9644\u52A0\u5230\u8BA2\u5355\u9879\u3002\u6B64\u4E8B\u4EF6\u5E94\u4EC5\u5728\u8BA2\u5355\u7F16\u8F91\u8868\u5355\u4E0A\u5DE5\u4F5C\u3002"}),"\n",(0,l.jsx)(r.h3,{id:"\u89E3\u51B3\u65B9\u6848-2",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"WHEN LOCAL FORMS order SETCHANGED(book(OrderDetail d)) DO {\r\n    price(d) <- price(book(d));\r\n}\n"})}),"\n",(0,l.jsx)(r.p,{children:"\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u53EA\u6709\u5F53\u4E66\u7C4D\u88AB\u66F4\u6539\u6216\u8BBE\u7F6E\u65F6\uFF0C\u4E8B\u4EF6\u624D\u4F1A\u88AB\u89E6\u53D1\u3002\u5F53\u4E66\u7C4D\u88AB\u5220\u9664\u65F6\uFF0C\u4EF7\u683C\u4E0D\u4F1A\u6539\u53D8\u3002"}),"\n",(0,l.jsxs)(r.p,{children:["\u5982\u679C\u6CA1\u6709",(0,l.jsx)(r.code,{children:"FORMS"}),"\u5757\uFF0C\u6B64\u4E8B\u4EF6\u5C06\u7531\u8BA2\u5355\u9879\u4E66\u7C4D\u7684\u4EFB\u4F55\u66F4\u6539\u89E6\u53D1\u3002\u4F8B\u5982\uFF0C\u5F53\u8BA2\u5355\u5728\u4EFB\u4F55\u5176\u4ED6\u8868\u5355\u4E2D\u5BFC\u5165\u65F6\u3002"]}),"\n",(0,l.jsx)(r.h2,{id:"\u793A\u4F8B-4",children:"\u793A\u4F8B 4"}),"\n",(0,l.jsx)(r.h3,{id:"\u4EFB\u52A1-3",children:"\u4EFB\u52A1"}),"\n",(0,l.jsxs)(r.p,{children:["\u7C7B\u4F3C\u4E8E",(0,l.jsx)(r.a,{href:"#%E7%A4%BA%E4%BE%8B-1",children:(0,l.jsx)(r.strong,{children:"\u793A\u4F8B 1"})}),"\u3002"]}),"\n",(0,l.jsx)(r.p,{children:"\u6211\u4EEC\u9700\u8981\u7EC4\u7EC7\u8BA2\u5355\u5220\u9664\u7684\u65E5\u5FD7\u8BB0\u5F55"}),"\n",(0,l.jsx)(r.h3,{id:"\u89E3\u51B3\u65B9\u6848-3",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,l.jsx)(r.pre,{children:(0,l.jsx)(r.code,{className:"language-lsf",children:"CLASS OrderLog '\u8BA2\u5355\u5220\u9664\u65E5\u5FD7';\r\ndate '\u8BA2\u5355\u65E5\u671F' = DATA DATE (OrderLog);\r\nnumber '\u8BA2\u5355\u7F16\u53F7' = DATA INTEGER (OrderLog);\r\n\r\ndateTime '\u65E5\u671F\u65F6\u95F4' = DATA DATETIME (OrderLog);\r\nuser '\u7528\u6237' = DATA User (OrderLog);\r\n\r\nWHEN DROPPED(Order o IS Order) DO {\r\n    NEW l = OrderLog {\r\n        date(l) <- PREV(date(o));\r\n        number(l) <- PREV(number(o));\r\n\r\n        dateTime(l) <- currentDateTime();\r\n        user(l) <- currentUser();\r\n    }\r\n}\n"})}),"\n",(0,l.jsxs)(r.p,{children:["\u5728\u5220\u9664\u8BA2\u5355\u5E76\u89E6\u53D1\u5E26\u6709",(0,l.jsx)(r.code,{children:"DROPPED"}),"\u4FEE\u9970\u7B26\u7684\u4E8B\u4EF6\u65F6\uFF0C\u91CD\u8981\u7684\u662F\u8981\u8BB0\u4F4F\u8BE5\u5BF9\u8C61\u5DF2\u4E0D\u5B58\u5728\uFF0C\u5E76\u4E14\u6240\u6709\u5C06\u5176\u4F5C\u4E3A\u8F93\u5165\u7684\u5C5E\u6027\u90FD\u4F1A\u7ED9\u51FA",(0,l.jsx)(r.code,{children:"NULL"}),"\u503C\u3002\u56E0\u6B64\uFF0C\u6211\u4EEC\u9700\u8981\u901A\u8FC7",(0,l.jsx)(r.code,{children:"PREV"}),"\u64CD\u4F5C\u7B26\u800C\u4E0D\u662F\u76F4\u63A5\u8BBF\u95EE\u5B83\u4EEC\u3002"]})]})}function h(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,l.jsx)(r,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},28453:function(e,r,n){n.d(r,{R:()=>i,x:()=>t});var d=n(96540);let l={},s=d.createContext(l);function i(e){let r=d.useContext(s);return d.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),d.createElement(s.Provider,{value:r},e.children)}}}]);