"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([["58863"],{1863:function(e,n,l){l.r(n),l.d(n,{metadata:()=>r,default:()=>h,frontMatter:()=>o,contentTitle:()=>t,toc:()=>i,assets:()=>d});var r=JSON.parse('{"id":"How-to_GROUP_SUM","title":"GROUP SUM","description":"\u793A\u4F8B 1","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/How-to_GROUP_SUM.md","sourceDirName":".","slug":"/How-to_GROUP_SUM","permalink":"/How-to_GROUP_SUM","draft":false,"unlisted":false,"editUrl":"https://github.com/lsfusion/platform/edit/master/docs/zh-CN/How-to_GROUP_SUM.md","tags":[],"version":"current","lastUpdatedAt":null,"frontMatter":{"title":"GROUP SUM"},"sidebar":"learn","previous":{"title":"\u8BA1\u7B97","permalink":"/How-to_Computations"},"next":{"title":"GROUP MAX/MIN/AGGR","permalink":"/How-to_GROUP_MAX_MIN_AGGR"}}'),s=l(74848),c=l(28453);let o={title:"GROUP SUM"},t,d={},i=[{value:"\u793A\u4F8B 1",id:"\u793A\u4F8B-1",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:3},{value:"\u793A\u4F8B 2",id:"\u793A\u4F8B-2",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-1",level:3},{value:"\u793A\u4F8B 3",id:"\u793A\u4F8B-3",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-2",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-2",level:3},{value:"\u793A\u4F8B 4",id:"\u793A\u4F8B-4",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-3",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-3",level:3},{value:"\u793A\u4F8B 5",id:"\u793A\u4F8B-5",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-4",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-4",level:3}];function a(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u793A\u4F8B-1",children:"\u793A\u4F8B 1"}),"\n",(0,s.jsx)(n.h3,{id:"\u4EFB\u52A1",children:"\u4EFB\u52A1"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u6709\u4E00\u7EC4\u4E0E\u7279\u5B9A\u7C7B\u522B\u76F8\u5173\u8054\u7684\u56FE\u4E66\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"CLASS Book '\u56FE\u4E66';\r\nCLASS Category '\u7C7B\u522B';\r\n\r\ncategory '\u7C7B\u522B' = DATA Category (Book);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u8BA1\u7B97\u7C7B\u522B\u4E2D\u7684\u56FE\u4E66\u6570\u91CF\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"countBooks '\u56FE\u4E66\u6570\u91CF' (Category c) = GROUP SUM 1 BY category(Book book);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u793A\u4F8B-2",children:"\u793A\u4F8B 2"}),"\n",(0,s.jsx)(n.h3,{id:"\u4EFB\u52A1-1",children:"\u4EFB\u52A1"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u6709\u4E00\u7EC4\u4E0E\u7279\u5B9A\u6807\u7B7E\u76F8\u5173\u8054\u7684\u56FE\u4E66\u3002\u6BCF\u672C\u4E66\u53EF\u4EE5\u540C\u65F6\u4E0E\u591A\u4E2A\u6807\u7B7E\u76F8\u5173\u8054\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"CLASS Tag '\u6807\u7B7E';\r\n\r\nin '\u5728' = DATA BOOLEAN (Tag, Book);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u8BA1\u7B97\u6807\u7B7E\u4E2D\u7684\u56FE\u4E66\u6570\u91CF\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-1",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"countBooks '\u56FE\u4E66\u6570\u91CF' (Tag t) = GROUP SUM 1 IF in(t, Book b);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u793A\u4F8B-3",children:"\u793A\u4F8B 3"}),"\n",(0,s.jsx)(n.h3,{id:"\u4EFB\u52A1-2",children:"\u4EFB\u52A1"}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u6709\u5173\u4E8E\u56FE\u4E66\u79FB\u52A8\u7684\u4FE1\u606F\uFF1A\u6BCF\u6761\u8BB0\u5F55\u90FD\u4E0E\u56FE\u4E66\u672C\u8EAB\u548C\u53D1\u751F\u79FB\u52A8\u7684\u4ED3\u5E93\u76F8\u5173\u8054\uFF0C\u5E76\u4E14\u8FD8\u5305\u542B\u6570\u91CF\u548C\u64CD\u4F5C\u7C7B\u578B\uFF08\u6536\u8D27/\u53D1\u8D27\uFF09\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"CLASS Stock '\u4ED3\u5E93';\r\n\r\n\r\nCLASS Ledger '\u79FB\u52A8\u8BB0\u5F55';\r\nbook '\u56FE\u4E66' = DATA Book (Ledger);\r\nstock '\u4ED3\u5E93' = DATA Stock (Ledger);\r\n\r\nquantity '\u6570\u91CF' = DATA INTEGER (Ledger);\r\nout '\u652F\u51FA' = DATA BOOLEAN (Ledger);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u8BA1\u7B97\u4ED3\u5E93\u4E2D\u67D0\u672C\u4E66\u7684\u5F53\u524D\u4F59\u989D\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-2",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"TABLE bookStock (Book, Stock);\r\ncurrentBalance '\u5F53\u524D\u4F59\u989D' (Book b, Stock s) = GROUP SUM IF out(Ledger l) THEN -quantity(l) ELSE quantity(l) BY book(l), stock(l) MATERIALIZED;\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5EFA\u8BAE\u5C06",(0,s.jsx)(n.code,{children:"currentBalance"}),"\u5C5E\u6027\u6807\u8BB0\u4E3A",(0,s.jsx)(n.a,{href:"/Materializations",children:(0,s.jsx)(n.code,{children:"MATERIALIZED"})}),"\uFF0C\u8FD9\u6837\u5728\u8BFB\u53D6\u5F53\u524D\u4F59\u989D\u65F6\uFF0C\u7CFB\u7EDF\u53EF\u4EE5\u4ECE",(0,s.jsx)(n.code,{children:"bookStock"}),"\u8868\u4E2D\u83B7\u53D6\u8BA1\u7B97\u503C\uFF0C\u800C\u4E0D\u662F\u6839\u636E\u6240\u6709\u79FB\u52A8\u8BB0\u5F55\u91CD\u65B0\u8BA1\u7B97\u8BE5\u503C\u3002\u867D\u7136\u8FD9\u4F1A\u51CF\u6162\u5199\u5165\u8FC7\u7A0B\uFF08\u56E0\u4E3A\u5199\u5165\u6BCF\u6761\u79FB\u52A8\u8BB0\u5F55\u90FD\u9700\u8981\u66F4\u65B0\u5F53\u524D\u4F59\u989D\uFF09\uFF0C\u4F46\u8BFB\u53D6\u8FC7\u7A0B\u5C06\u53D8\u5F97\u66F4\u5FEB\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u6CE8\u610F\uFF0C\u60A8\u4E0D\u9700\u8981\u660E\u786E\u6307\u5B9A\u5728\u54EA\u4E2A\u8868\u4E2D\u4FDD\u5B58",(0,s.jsx)(n.code,{children:"currentBalance"}),"\u5C5E\u6027\uFF0C\u56E0\u4E3A\u7CFB\u7EDF\u4F1A\u4F7F\u7528\u7B7E\u540D\u6765\u627E\u51FA\u6700\u9002\u5408\u5B83\u7684\u8868\uFF08\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u8FD9\u5C06\u662F",(0,s.jsx)(n.code,{children:"bookStock"}),"\uFF09\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u793A\u4F8B-4",children:"\u793A\u4F8B 4"}),"\n",(0,s.jsx)(n.h3,{id:"\u4EFB\u52A1-3",children:"\u4EFB\u52A1"}),"\n",(0,s.jsxs)(n.p,{children:["\u4E0E",(0,s.jsx)(n.a,{href:"#%E7%A4%BA%E4%BE%8B-3",children:(0,s.jsx)(n.strong,{children:"\u793A\u4F8B 3"})}),"\u7C7B\u4F3C\uFF0C\u4F46\u6BCF\u6761\u79FB\u52A8\u8BB0\u5F55\u90FD\u4E0E\u79FB\u52A8\u65E5\u671F\u76F8\u5173\u8054\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"date '\u65E5\u671F' = DATA DATE (Ledger) INDEXED; // \u6700\u597D\u6DFB\u52A0\u7D22\u5F15\u4EE5\u5FEB\u901F\u6309\u65E5\u671F\u8FC7\u6EE4\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u8BA1\u7B97\u7279\u5B9A\u65E5\u671F\u4ED3\u5E93\u4E2D\u67D0\u672C\u4E66\u7684\u5F53\u524D\u4F59\u989D\uFF08\u622A\u81F3\u5F53\u5929\u65E9\u4E0A\uFF0C\u4E0D\u5305\u62EC\u5F53\u5929\u53D1\u751F\u7684\u79FB\u52A8\uFF09\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-3",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"// \u9009\u9879 1\r\nbalance1 '\u622A\u81F3\u65E5\u671F\u7684\u4F59\u989D' (Book b, Stock s, DATE d) = GROUP SUM (IF out(Ledger l) THEN -quantity(l) ELSE quantity(l)) IF date(l) < d BY book(l), stock(l);\r\n\r\n// \u9009\u9879 2\r\nbalance2 '\u622A\u81F3\u65E5\u671F\u7684\u4F59\u989D' (Book b, Stock s, DATE d) = currentBalance(b, s) (-) [ GROUP SUM (IF out(Ledger l) THEN -quantity(l) ELSE quantity(l)) IF date(l) >= d BY book(l), stock(l)](b, s);\n"})}),"\n",(0,s.jsx)(n.p,{children:'\u7B2C\u4E8C\u79CD\u9009\u9879\u66F4\u53EF\u53D6\u3002\u7531\u4E8E\u8BF7\u6C42\u901A\u5E38\u5F15\u7528\u6700\u8FD1\u7684\u65E5\u671F\uFF0C\u670D\u52A1\u5668\u5C06\u4ECE\u5F53\u524D\u4F59\u989D"\u8FFD\u6EAF\u6027"\u5730\u8BA1\u7B97\u7ED3\u679C\uFF0C\u4ECE\u800C\u5206\u6790\u66F4\u5C11\u7684\u8BB0\u5F55\u3002'}),"\n",(0,s.jsx)(n.h2,{id:"\u793A\u4F8B-5",children:"\u793A\u4F8B 5"}),"\n",(0,s.jsx)(n.h3,{id:"\u4EFB\u52A1-4",children:"\u4EFB\u52A1"}),"\n",(0,s.jsxs)(n.p,{children:["\u4E0E",(0,s.jsx)(n.a,{href:"#%E7%A4%BA%E4%BE%8B-3",children:(0,s.jsx)(n.strong,{children:"\u793A\u4F8B 3"})}),"\u7C7B\u4F3C\uFF0C\u4F46\u6211\u4EEC\u9700\u8981\u8BA1\u7B97\u67D0\u672C\u4E66\u5728\u6240\u6709\u4ED3\u5E93\u4E2D\u7684\u5F53\u524D\u4F59\u989D\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-4",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lsf",children:"currentBalance '\u5F53\u524D\u4F59\u989D' (Book b) = GROUP SUM currentBalance(b, Stock s);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4E0E\u6240\u6709\u4ED3\u5E93\u7684\u5F53\u524D\u4F59\u989D\u4E0D\u540C\uFF0C\u5982\u679C\u60A8\u53EA\u6709\u51E0\u4E2A\u4ED3\u5E93\uFF0C\u5219\u5C06\u6B64\u5C5E\u6027\u6807\u8BB0\u4E3A",(0,s.jsx)(n.code,{children:"MATERIALIZED"}),"\u662F\u4E0D\u5408\u7406\u7684 - \u5426\u5219\uFF0C\u5F53\u591A\u4E2A\u7528\u6237\u5C1D\u8BD5\u540C\u65F6\u5728\u4E0D\u540C\u4ED3\u5E93\u5199\u5165\u540C\u4E00\u672C\u4E66\u7684\u79FB\u52A8\u65F6\uFF0C\u53EF\u80FD\u4F1A\u53D1\u751FUPDATE CONFLICT\u3002"]})]})}function h(e={}){let{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:function(e,n,l){l.d(n,{R:()=>o,x:()=>t});var r=l(96540);let s={},c=r.createContext(s);function o(e){let n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);