"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([["82435"],{71521:function(e,n,d){d.r(n),d.d(n,{metadata:()=>t,default:()=>u,frontMatter:()=>o,contentTitle:()=>a,toc:()=>i,assets:()=>s});var t=JSON.parse('{"id":"How-to_WHILE","title":"WHILE","description":"\u793A\u4F8B 1","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/How-to_WHILE.md","sourceDirName":".","slug":"/How-to_WHILE","permalink":"/How-to_WHILE","draft":false,"unlisted":false,"editUrl":"https://github.com/lsfusion/platform/edit/master/docs/zh-CN/How-to_WHILE.md","tags":[],"version":"current","lastUpdatedAt":null,"frontMatter":{"title":"WHILE"},"sidebar":"learn","previous":{"title":"IF/CASE","permalink":"/How-to_IF_CASE"},"next":{"title":"NEWSESSION","permalink":"/How-to_NEWSESSION"}}'),r=d(74848),l=d(28453);let o={title:"WHILE"},a,s={},i=[{value:"\u793A\u4F8B 1",id:"\u793A\u4F8B-1",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:3},{value:"\u793A\u4F8B 2",id:"\u793A\u4F8B-2",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-1",level:3},{value:"\u793A\u4F8B 3",id:"\u793A\u4F8B-3",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-2",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-2",level:3}];function c(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"\u793A\u4F8B-1",children:"\u793A\u4F8B 1"}),"\n",(0,r.jsx)(n.h3,{id:"\u4EFB\u52A1",children:"\u4EFB\u52A1"}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4EEC\u6709\u4E00\u4E2A\u8BA2\u5355\uFF0C\u5176\u4E2D\u5B9A\u4E49\u4E86\u65E5\u671F\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"CLASS Order '\u8BA2\u5355';\n\ndate '\u65E5\u671F' = DATA DATE (Order);\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u663E\u793A\u4E00\u6761\u6D88\u606F\uFF0C\u5176\u4E2D\u5305\u542B\u7ED9\u5B9A\u95F4\u9694\u5185\u6BCF\u5929\u7684\u8BA2\u5355\u6570\u91CF\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"countOrders (DATE date) = GROUP SUM 1 BY date(Order o);\n\nmessageCountOrders '\u7EDF\u8BA1\u8BA2\u5355\u6570\u91CF' (DATE dFrom, DATE dTo)  {\n    // \u9009\u9879 1\n    LOCAL date = DATE ();\n    date() <- dFrom;\n\n    WHILE date() <= dTo DO {\n        MESSAGE '\u65E5\u671F ' + date () + ' \u7684\u8BA2\u5355\u6570\u91CF: ' + OVERRIDE countOrders(date()), 0.0;\n        date() <- sum(date(), 1);\n    }\n\n    // \u9009\u9879 2\n    FOR iterate(DATE date, dFrom, dTo) DO\n        MESSAGE '\u65E5\u671F ' + date + ' \u7684\u8BA2\u5355\u6570\u91CF: ' + OVERRIDE countOrders(date()), 0.0;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8FD9\u4E24\u4E2A\u9009\u9879\u5C06\u63D0\u4F9B\u76F8\u540C\u7684\u7ED3\u679C\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"sum"}),"\u5C5E\u6027\u5728",(0,r.jsx)(n.code,{children:"Time"}),"\u7CFB\u7EDF",(0,r.jsx)(n.a,{href:"/Modules",children:"\u6A21\u5757"}),"\u4E2D\u5B9A\u4E49\uFF0C\u7528\u4E8E\u5728\u7ED9\u5B9A\u65E5\u671F\u4E0A\u6DFB\u52A0\u4E00\u5929\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u793A\u4F8B-2",children:"\u793A\u4F8B 2"}),"\n",(0,r.jsx)(n.h3,{id:"\u4EFB\u52A1-1",children:"\u4EFB\u52A1"}),"\n",(0,r.jsxs)(n.p,{children:["\u7C7B\u4F3C\u4E8E",(0,r.jsx)(n.a,{href:"#example-1",children:(0,r.jsx)(n.strong,{children:"\u793A\u4F8B 1"})}),"\u3002\u6211\u4EEC\u8FD8\u5B9A\u4E49\u4E86\u8BA2\u5355\u884C\uFF0C\u6BCF\u884C\u5305\u542B\uFF08\u5B8C\u6574\uFF09\u91D1\u989D\u548C\u6298\u6263\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"CLASS OrderDetail '\u8BA2\u5355\u884C';\norder '\u8BA2\u5355' = DATA Order (OrderDetail) NONULL DELETE;\n\nsum '\u91D1\u989D' = DATA NUMERIC[14,2] (OrderDetail);\ndiscountSum '\u6298\u6263\u91D1\u989D' = DATA NUMERIC[14,2] (OrderDetail);\n"})}),"\n",(0,r.jsx)(n.p,{children:'\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u64CD\u4F5C\uFF0C\u4ECE\u91D1\u989D\u6700\u5927\u7684\u884C\u5F00\u59CB\uFF0C\u6309\u884C"\u5206\u914D"\u7ED9\u5B9A\u7684\u6298\u6263\u3002'}),"\n",(0,r.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-1",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"distributeDiscount '\u5206\u914D\u6298\u6263' (Order o, NUMERIC[14,2] discount)  {\n    LOCAL discount = NUMERIC[14,2] ();\n    discount() <- discount;\n\n    LOCAL leftSum = NUMERIC[14,2] (OrderDetail);\n    leftSum(OrderDetail d) <- sum(d) WHERE order(d) == o;\n\n    WHILE discount() > 0 DO {\n        // \u67E5\u627E\u5269\u4F59\u91D1\u989D\u6700\u5927\u7684\u884C\n        FOR OrderDetail d == [ GROUP LAST OrderDetail od ORDER leftSum(od), od BY order(od)](o) DO { \n            discountSum(d) <- MIN leftSum(d), discount();\n            discount() <- discount() (-) discountSum(d);\n        }\n        IF (GROUP SUM 1 IF leftSum(OrderDetail d) > 0) THEN\n            BREAK; // \u6CA1\u6709\u5269\u4F59\u53EF\u5206\u914D\u7684\u91D1\u989D\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u793A\u4F8B-3",children:"\u793A\u4F8B 3"}),"\n",(0,r.jsx)(n.h3,{id:"\u4EFB\u52A1-2",children:"\u4EFB\u52A1"}),"\n",(0,r.jsx)(n.p,{children:"\u4FEE\u6539\u8D26\u672C\u4F59\u989D\u7684\u903B\u8F91\u5B9A\u4E49\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"CLASS Book '\u8D26\u672C';\n\nCLASS Ledger '\u4F59\u989D\u53D8\u66F4';\ndate '\u65E5\u671F' = DATA DATE (Ledger);\nbook '\u8D26\u672C' = DATA Book (Ledger);\nquantity '\u6570\u91CF' = DATA NUMERIC[14,2] (Ledger);\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u64CD\u4F5C\uFF0C\u8BA1\u7B97\u7ED9\u5B9A\u65F6\u95F4\u6BB5\u5185\u7684\u7D2F\u8BA1\uFF08\u79EF\u5206\uFF09\u4F59\u989D\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-2",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lsf",children:"calculateIntegral '\u8BA1\u7B97\u7D2F\u8BA1\u4F59\u989D' (DATE dFrom, DATE dTo)  {\n    LOCAL date = DATE();\n    date() <- dFrom;\n\n    LOCAL balance = NUMERIC[14,2] (Book);\n    balance(Book b) <- [ GROUP SUM quantity(Ledger l) IF date(l) < dFrom BY book(l)](b);\n\n    LOCAL cumBalance = NUMERIC[14,2] (Book);\n\n    WHILE date() <= dTo DO {\n        cumBalance(Book b) <- cumBalance(b) (+) balance(b); //\n        balance(Book b) <- balance(b) (+) [ GROUP SUM quantity(Ledger l) BY book(l), date(l)](b, date());\n        date() <- sum(date(), 1);\n    }\n\n    FOR cumBalance(Book b) DO {\n        MESSAGE '\u8D26\u672C ' + b + ' \u7684\u7D2F\u8BA1\u4F59\u989D: ' + cumBalance(b);\n    }\n}\n"})})]})}function u(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:function(e,n,d){d.d(n,{R:()=>o,x:()=>a});var t=d(96540);let r={},l=t.createContext(r);function o(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);