"use strict";(self.webpackChunkls_fusion_docs=self.webpackChunkls_fusion_docs||[]).push([["18262"],{66529:function(e,n,r){r.r(n),r.d(n,{metadata:()=>s,default:()=>h,frontMatter:()=>t,contentTitle:()=>o,toc:()=>c,assets:()=>i});var s=JSON.parse('{"id":"How-to_FORMULA","title":"FORMULA","description":"\u793A\u4F8B1","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/How-to_FORMULA.md","sourceDirName":".","slug":"/How-to_FORMULA","permalink":"/How-to_FORMULA","draft":false,"unlisted":false,"editUrl":"https://github.com/lsfusion/platform/edit/master/docs/zh-CN/How-to_FORMULA.md","tags":[],"version":"current","lastUpdatedAt":null,"frontMatter":{"title":"FORMULA"},"sidebar":"learn","previous":{"title":"\u8BBF\u95EE\u5185\u90E8\u7CFB\u7EDF","permalink":"/How-to_Access_to_internal_systems"},"next":{"title":"INTERNAL","permalink":"/How-to_INTERNAL"}}'),d=r(74848),l=r(28453);let t={title:"FORMULA"},o,i={},c=[{value:"\u793A\u4F8B1",id:"\u793A\u4F8B1",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848",level:3},{value:"\u793A\u4F8B2",id:"\u793A\u4F8B2",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-1",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-1",level:3},{value:"\u793A\u4F8B3",id:"\u793A\u4F8B3",level:2},{value:"\u4EFB\u52A1",id:"\u4EFB\u52A1-2",level:3},{value:"\u89E3\u51B3\u65B9\u6848",id:"\u89E3\u51B3\u65B9\u6848-2",level:3}];function a(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h2,{id:"\u793A\u4F8B1",children:"\u793A\u4F8B1"}),"\n",(0,d.jsx)(n.h3,{id:"\u4EFB\u52A1",children:"\u4EFB\u52A1"}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4EEC\u6709\u4E00\u4E2A\u8BA2\u5355\u5217\u8868\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-lsf",children:"CLASS Order 'Order';\ndate 'Date' = DATA DATE (Order);\nnumber 'Number' = DATA STRING[30] (Order);\n\nFORM orders 'Purchase orders'\n    OBJECTS o = Order\n    PROPERTIES(o) date, number, NEW, DELETE\n;\n\nNAVIGATOR {\n    NEW orders;\n}\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4EEC\u9700\u8981\u5C06\u6B64\u5217\u8868\u5BFC\u51FA\u4E3ACSV\uFF0C\u5E76\u5C06\u65E5\u671F\u4FDD\u6301\u4E3AISO\u683C\u5F0F",(0,d.jsx)(n.code,{children:"YYYY-MM-DD"}),"\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-lsf",children:"toISO = FORMULA STRING[10] 'to_char($1,\\'YYYY-MM-DD\\')';\n\nexportToCSV 'Export to CSV' () {\n    LOCAL file = FILE ();\n    EXPORT CSV FROM toISO(date(Order o)), number(o) TO file;\n    open(file());\n}\n\nEXTEND FORM orders\n    PROPERTIES() exportToCSV\n;\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u4EFB\u52A1\uFF0C\u6211\u4EEC\u4F7F\u7528",(0,d.jsxs)(n.a,{href:"/FORMULA_operator",children:[(0,d.jsx)(n.code,{children:"FORMULA"}),"\u64CD\u4F5C\u7B26"]}),"\u521B\u5EFA\u4E00\u4E2A\u65B0\u5C5E\u6027\uFF0C\u8BE5\u5C5E\u6027\u63A5\u53D7\u4E00\u4E2A\u65E5\u671F\u5E76\u4EE5",(0,d.jsx)(n.code,{children:"YYYY-MM-DD"}),"\u683C\u5F0F\u7684\u5B57\u7B26\u4E32\u8FD4\u56DE\u5176\u503C\u3002\u8868\u8FBE\u5F0F\u5305\u542B",(0,d.jsx)(n.a,{href:"https://www.postgresql.org/docs/11/functions-formatting.html",children:(0,d.jsx)(n.code,{children:"to_char"})}),"\uFF0C\u8FD9\u662F\u4E00\u4E2A\u6807\u51C6\u7684PostgreSQL\u51FD\u6570\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u793A\u4F8B2",children:"\u793A\u4F8B2"}),"\n",(0,d.jsx)(n.h3,{id:"\u4EFB\u52A1-1",children:"\u4EFB\u52A1"}),"\n",(0,d.jsxs)(n.p,{children:["\u7C7B\u4F3C\u4E8E",(0,d.jsx)(n.a,{href:"#example-1",children:(0,d.jsx)(n.strong,{children:"\u793A\u4F8B1"})}),"\u3002\u8BA2\u5355\u4E2D\u6DFB\u52A0\u4E86\u5305\u542B\u6570\u91CF\u548C\u91D1\u989D\u7684\u65B0\u884C\u3002"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-lsf",children:"CLASS OrderDetail;\norder = DATA Order (OrderDetail) NONULL DELETE;\n\nquantity 'Qty' = DATA NUMERIC[14,3] (OrderDetail);\nsum 'Amount' = DATA NUMERIC[14,2] (OrderDetail);\n\nEXTEND FORM orders\n    OBJECTS d = OrderDetail\n    PROPERTIES(d) quantity, sum, NEW, DELETE\n    FILTERS order(d) = o\n;\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u5C06\u7ED9\u5B9A\u8BA2\u5355\u4E2D\u7684\u6240\u6709\u884C\u5BFC\u51FA\u4E3ACSV\u6587\u4EF6\uFF0C\u5176\u4E2D\u6570\u91CF\u548C\u91D1\u989D\u5206\u522B\u7F29\u77ED\u4E3A3\u548C2\u4E2A\u5B57\u7B26\u3002\u6B64\u5916\uFF0C\u6570\u5B57\u5FC5\u987B\u5206\u6210\u4E09\u4F4D\u6570\u4E00\u7EC4\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-1",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-lsf",children:"toString = FORMULA TEXT 'to_char($1,$2)';\n\nexportToCSV 'Export to CSV' (Order o) {\n    LOCAL file = FILE ();\n    EXPORT CSV FROM toISO(date(o)), number(o), toString(quantity(OrderDetail d), '999 999.999'), toString(sum(d), '999 999.99') WHERE order(d) = o TO file;\n    open(file());\n}\n\nEXTEND FORM orders\n    PROPERTIES(o) exportToCSV\n;\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6211\u4EEC\u521B\u5EFA\u4E86",(0,d.jsx)(n.code,{children:"toString"}),"\u5C5E\u6027\uFF0C\u8BE5\u5C5E\u6027\u63A5\u53D7\u4E24\u4E2A\u53C2\u6570\uFF08\u6570\u503C\u548C\u683C\u5F0F\uFF09\u5E76\u8FD4\u56DE",(0,d.jsx)(n.code,{children:"TEXT"}),"\u7C7B\u578B\u7684\u503C\u3002\u5BFC\u51FA\u65F6\uFF0C\u6211\u4EEC\u5C06\u6240\u9700\u683C\u5F0F\u4F5C\u4E3A\u7B2C\u4E8C\u4E2A\u53C2\u6570\u4F20\u9012\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"\u793A\u4F8B3",children:"\u793A\u4F8B3"}),"\n",(0,d.jsx)(n.h3,{id:"\u4EFB\u52A1-2",children:"\u4EFB\u52A1"}),"\n",(0,d.jsxs)(n.p,{children:["\u7C7B\u4F3C\u4E8E",(0,d.jsx)(n.a,{href:"#example-2",children:(0,d.jsx)(n.strong,{children:"\u793A\u4F8B2"})}),"\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u6211\u4EEC\u9700\u8981\u6DFB\u52A0\u4E00\u5217\uFF0C\u5F53\u7ED9\u5B9A\u8BA2\u5355\u53F7\u4EC5\u5305\u542B\u6570\u5B57\u65F6\u5C06\u88AB\u6807\u8BB0\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u89E3\u51B3\u65B9\u6848-2",children:"\u89E3\u51B3\u65B9\u6848"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-lsf",children:"onlyDigits = FORMULA NULL BOOLEAN 'CASE WHEN trim($1) ~ \\'^[0-9]*$\\' THEN 1 ELSE NULL END';\n\nEXTEND FORM orders\n    PROPERTIES 'Only numbers' = onlyDigits(number(o))\n;\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u7531\u4E8E\u516C\u5F0F\u4E2D\u4F7F\u7528\u4E86\u5355\u5F15\u53F7\uFF0C\u8BF7\u786E\u4FDD\u7528\u53CD\u659C\u6760",(0,d.jsx)(n.code,{children:"\\"}),(0,d.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Escape_character",children:"\u8F6C\u4E49"}),"\u5B83\u4EEC\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u8BF7\u6CE8\u610F\uFF0C\u539F\u751F",(0,d.jsx)(n.code,{children:"BOOLEAN"}),"\u7C7B\u578B\u53EA\u5141\u8BB82\u4E2A\u503C\uFF1A",(0,d.jsx)(n.code,{children:"TRUE"}),"\u548C",(0,d.jsx)(n.code,{children:"NULL"}),"\u3002\u56E0\u6B64\uFF0C\u5728\u7F16\u5199\u903B\u8F91\u8868\u8FBE\u5F0F\u65F6\uFF0C\u8BF7\u786E\u4FDD\u5C06\u5176\u8D1F\u503C\u8F6C\u6362\u4E3A",(0,d.jsx)(n.code,{children:"NULL"}),"\u3002\u6B64\u5916\uFF0C\u5E73\u53F0\u5FC5\u987B\u660E\u786E\u77E5\u9053\u8868\u8FBE\u5F0F\u662F\u5426\u53EF\u4EE5\u8FD4\u56DE\u672A\u5B9A\u4E49\u7684\u503C\u3002\u8FD9\u5C31\u662F\u4E3A\u4EC0\u4E48",(0,d.jsx)(n.code,{children:"FORMULA"}),"\u5173\u952E\u5B57\u540E\u9762\u5FC5\u987B\u8DDF\u76F8\u5E94\u7684\u6807\u8BB0\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u5728\u6570\u636E\u5E93\u7EA7\u522B\uFF0C",(0,d.jsx)(n.code,{children:"BOOLEAN"}),"\u7C7B\u578B\u5B58\u50A8\u4E3A\u6570\u503C\uFF08",(0,d.jsx)(n.code,{children:"1"}),"\u6216",(0,d.jsx)(n.code,{children:"null"}),"\uFF09\uFF0C\u56E0\u6B64\u8FD9\u79CD\u7C7B\u578B\u7684\u5C5E\u6027\u4E5F\u5FC5\u987B\u8FD4\u56DE\u6570\u503C\u3002\u5F00\u53D1\u4EBA\u5458\u5FC5\u987B\u68C0\u67E5\u8868\u8FBE\u5F0F\u7684\u8FD4\u56DE\u7C7B\u578B\u662F\u5426\u4E0E\u6307\u5B9A\u7684\u7C7B\u578B\u5339\u914D\u3002\u5426\u5219\uFF0C\u884C\u4E3A\u5C06\u4E0D\u53EF\u9884\u6D4B\uFF08\u4F46\u5728\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u8BF7\u6C42\u5C06\u7B80\u5355\u5730\u8FD4\u56DE\u9519\u8BEF\uFF09\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["\u8BF7\u8BB0\u4F4F\uFF0C\u5982\u679C\u7531",(0,d.jsx)(n.code,{children:"FORMULA"}),"\u64CD\u4F5C\u7B26\u7EC4\u6210\u7684\u4EFB\u4F55\u5C5E\u6027\u63A5\u6536",(0,d.jsx)(n.code,{children:"NULL"}),"\u4F5C\u4E3A\u53C2\u6570\uFF0C\u5219\u6574\u4F53\u7ED3\u679C\u5C06\u59CB\u7EC8\u4E3A",(0,d.jsx)(n.code,{children:"NULL"}),"\u3002"]})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},28453:function(e,n,r){r.d(n,{R:()=>t,x:()=>o});var s=r(96540);let d={},l=s.createContext(d);function t(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);